# 모듈형 자바스크립트와 디자인 패턴

## 10.2 AMD
- 모듈과 의존성 모두를 비동기적으로 로드할 수 있도록 설계된 모듈 정의 방식

<br />

### 10.2.1 모듈 알아보기
#### define 메서드
- 모듈 정의
- 이름이 있는 모듈이나 익명 모듈 정의
- **module_id** (옵셔널) 인자: 비 AMD 모듈 연결 도구를 사용하는 경우에 필요, 생략할 경우 익명 모듈이 됨
- **dependencies** (옵셔널) 인자: 정의하고 있는 모듈에서 필요로 하는 의존성 배열
- **definition function** 인자: 모듈을 초기화하기 위해 실행되는 함수

<br />

#### require 메서드
- 의존성 로딩 처리
- 최상위 자바스크립트 파일이나 모듈 내에서 의존성을 동적으로 가져오고자 할 때 사용됨

<br />

## 10.3 CommonJS
- 서버 사이드에서 모듈을 선언하는 간단한 API를 지정하는 모듈 제안
- AMD보다 더욱 광범위한 부분을 다룸

<br />

### 10.3.1 CommonJS 시작하기
- 재사용 가능한 자바스크립트 코드로써 외부 의존 코드에 공개할 특정 객체를 내보냄
- AMD와 달리 모듈을 함수로 감싸지 않아도 됨
- **exports** 변수: 다른 모듈에 내보내고자 하는 객체를 담음
- **require** 변수: 다른 모듈에서 내보낸 객체를 가져올 때 사용

<br />

## 10.4 AMD vs CommonJS
### AMD
- 브라우저 우선 접근 방식 채택
- 비동기 동작과 간소화된 하위 호환성
- 파일 I/O에 대한 개념 없음
- 객체, 함수, 생성자, 문자열, JSON 등 다양한 형태의 모듈을 지원
- 브라우저에서 자체적으로 실행된다는 면에서 유연함

<br />

### CommonJS
- 서버 우선 접근 방식
- 동기적 작동
- 전역 변수와의 독립성과 미래 서버 환경 고려
- 객체만을 모듈로 지원

### 10.4.1 UMD
- 기존 AMD와 CommonJS의 약점을 해결하기 위해 만들어짐

### AMD vs CommonJS vs UMD
| 항목                | AMD (Asynchronous Module Definition)                    | CommonJS                     | UMD (Universal Module Definition)  |
| ----------------- | ------------------------------------------------------- | ---------------------------- | ---------------------------------- |
| **주 사용 환경**       | 브라우저                                                    | Node.js                      | 브라우저 + Node.js 모두                  |
| **로딩 방식**         | 비동기 (Asynchronous)                                      | 동기 (Synchronous)             | 둘 다 지원                             |
| **정의 방식**         | `define(['dep'], function(dep) { ... })`                | `const dep = require('dep')` | AMD와 CommonJS를 모두 감싸서 사용           |
| **비동기 지원**        | O (비동기 로딩에 최적화)                                         | X (동기적 실행, I/O 적합)           | 조건에 따라 동기/비동기 선택                   |
| **대표 도구/환경**      | RequireJS                                               | Node.js, Browserify          | 라이브러리 배포 시 (ex: Lodash, Moment.js) |
| **모듈 exports 방식** | `return {}` 또는 `define(..., function() { return ... })` | `module.exports = ...`       | AMD/CommonJS에 따라 다르게 export        |
| **사용 복잡도**        | 상대적으로 복잡                                                | 간단                           | 가장 복잡 (양쪽 호환 고려)                   |
| **트리 셰이킹**        | 지원 안 함 (ESM만 가능)                                        | 지원 안 함                       | 지원 안 함                             |
| **목적**            | 브라우저에서 모듈화 구현                                           | 서버 사이드 JS 실행 환경 제공           | 범용성 (라이브러리 배포 호환성 확보)              |

